<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">

<hibernate-mapping>
    <class name="org.ibit.rol.sac.model.Edificio" discriminator-value="edificio" table="RSC_EDIFIC">
        <cache usage="read-write"/>
        <id name="id" unsaved-value="null" column="EDI_CODI">
            <generator class="sequence">
                <param name="sequence">RSC_SEQ_ALL</param>
            </generator>
        </id>
		<discriminator column="EDI_TYPE" type="string" length="64"/>
        <property name="direccion" length="256" column="EDI_DIRECC"/>
        <property name="codigoPostal" length="64" column="EDI_CODPOS"/>
        <property name="poblacion" length="64" column="EDI_POBLAC"/>

        <property name="telefono" length="64" column="EDI_TELEFO"/>
        <property name="fax" length="64" column="EDI_FAX"/>
        <property name="email" length="256" column="EDI_EMAIL"/>

        <many-to-one name="fotoPequenya" cascade="all" column="EDI_FOTOP" foreign-key="RSC_EDIFOP_FK"/>
        <many-to-one name="fotoGrande" cascade="all" column="EDI_FOTOG" foreign-key="RSC_EDIFOG_FK"/>
        <many-to-one name="plano" cascade="all" column="EDI_PLANO" foreign-key="RSC_EDIPLA_FK"/>
        <property name="latitud" length="15" column="EDI_LAT"/>
        <property name="longitud" length="15" column="EDI_LNG"/>
        
        <set name="unidadesAdministrativas" table="RSC_UNAEDI" lazy="true">
	        <cache usage="read-write"/>
            <key column="UNE_CODEDI" foreign-key="RSC_UNEEDI_FK"/>
            <many-to-many class="org.ibit.rol.sac.model.UnidadAdministrativa" column="UNE_CODUNA" foreign-key="RSC_UNEUNA_FK" />
        </set>

        <map name="traducciones" cascade="all" table="RSC_TRAEDI">
            <cache usage="read-write"/>
            <key column="TED_CODEDI" foreign-key="RSC_TEDEDI_FK"/>
            <index column="TED_CODIDI" type="string" length="2"/>
            <composite-element class="org.ibit.rol.sac.model.TraduccionEdificio">
                <property name="descripcion" length="4000" column="TED_DESCRI"/>
            </composite-element>
        </map>
        
        <subclass name="org.ibit.rol.sac.model.EdificioRemoto" discriminator-value="edificioRemoto">
            <property name="idExterno" column="EDR_IDEXTE"/>
            <many-to-one name="administracionRemota" column="EDR_CODADM" foreign-key="RSC_EDRADM_FK" />

        </subclass>
    </class>
</hibernate-mapping>