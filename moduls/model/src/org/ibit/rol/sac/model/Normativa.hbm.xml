<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">

<hibernate-mapping>
    <class name="org.ibit.rol.sac.model.Normativa" table="RSC_NORMAT" discriminator-value="normativa">
        <cache usage="read-write"/>
        <id name="id" unsaved-value="null" column="NOR_CODI">
            <generator class="sequence">
                <param name="sequence">RSC_SEQ_ALL</param>
            </generator>
        </id>

        <discriminator column="NOR_TYPE" type="string" length="64"/>

        <property name="numero" column="NOR_NUMERO"/>
        <property name="registro" column="NOR_REGIST"/>
        <property name="ley" length="256" column="NOR_LEY"/>
        <property name="fecha" column="NOR_FECHA"/>
        <property name="fechaBoletin" column="NOR_FECBOL"/>
        <property name="validacion" column="NOR_VALIDA"/>
        <property name="codiVuds" column="NOR_CODIVUDS"/>
        <property name="descCodiVuds" column="NOR_DESCCODIVUDS"/>
        

        <set name="afectadas" table="RSC_AFECTA" cascade="none" lazy="true">
            <cache usage="read-write"/>
            <key column="AFE_CODNOR" foreign-key="RSC_AFENOR_FK"/>
            <composite-element class="org.ibit.rol.sac.model.Afectacion">
                <parent name="afectante" />
                <many-to-one name="normativa" column="AFE_CODNOA" foreign-key="RSC_AFENOA_FK"/>
                <many-to-one name="tipoAfectacion" column="AFE_CODTIA" foreign-key="RSC_AFETIA_FK"/>
            </composite-element>
        </set>

        <set name="afectantes" table="RSC_AFECTA" cascade="none" inverse="true" lazy="true">
            <cache usage="read-write"/>
            <key column="AFE_CODNOA" foreign-key="RSC_AFENOA_FK"/>
            <composite-element class="org.ibit.rol.sac.model.Afectacion">
                <parent name="normativa" />
                <many-to-one name="afectante" column="AFE_CODNOR" foreign-key="RSC_AFENOR_FK"/>
                <many-to-one name="tipoAfectacion" column="AFE_CODTIA" foreign-key="RSC_AFETIA_FK"/>
            </composite-element>
        </set>

        <many-to-one name="boletin" column="NOR_CODBOL" foreign-key="RSC_NORBOL_FK"/>
        <many-to-one name="tipo" column="NOR_CODTIP" foreign-key="RSC_NORTIP_FK"/>

        <set name="procedimientos" table="RSC_PRONOR" inverse="true" lazy="true">
            <cache usage="read-write"/>
            <key column="PRN_CODNOR" foreign-key="RSC_PRNNOR_FK"/>
            <many-to-many class="org.ibit.rol.sac.model.ProcedimientoLocal" column="PRN_CODPRO" foreign-key="RSC_PRNPRO_FK" />
        </set>

        <subclass name="org.ibit.rol.sac.model.NormativaLocal" discriminator-value="normativaLocal">
            <many-to-one name="unidadAdministrativa" column="NOR_CODUNA" foreign-key="RSC_NORUNA_FK"/>
            <map name="traducciones"  cascade="all" table="RSC_TRANOL">
                <cache usage="read-write"/>
                <key column="TNL_CODNOR" foreign-key="RSC_TNLNOR_FK"/>
                <index column="TNL_CODIDI" type="string" length="2"/>
                <composite-element class="org.ibit.rol.sac.model.TraduccionNormativa">
                    <property name="seccion" length="256" column="TNL_SECCIO"/>
                    <property name="apartado" length="256" column="TNL_APARTA"/>
                    <property name="paginaInicial" column="TNL_PAGINI"/>
                    <property name="paginaFinal" column="TNL_PAGFIN"/>
                    <property name="titulo" length="512" column="TNL_TITULO"/>
                    <property name="enlace" length="512" column="TNL_ENLACE"/>
                    <many-to-one  cascade="all" name="archivo" column="TNL_CODARC" foreign-key="RSC_TNLARC_FK"/>
                    <property name="observaciones" length="4000" column="TNL_OBSERV"/>
                </composite-element>
            </map>
        </subclass>

        <subclass name="org.ibit.rol.sac.model.NormativaExterna" discriminator-value="normativaExterna">
            <map name="traducciones" cascade="all" table="RSC_TRANOE">
                <cache usage="read-write"/>
                <key column="TNE_CODNOR" foreign-key="RSC_TNENOR_FK"/>
                <index column="TNE_CODIDI" type="string" length="2"/>
                <composite-element class="org.ibit.rol.sac.model.TraduccionNormativaExterna">
                    <property name="seccion" length="256" column="TNE_SECCIO"/>
                    <property name="apartado" length="256" column="TNE_APARTA"/>
                    <property name="paginaInicial" column="TNE_PAGINI"/>
                    <property name="paginaFinal" column="TNE_PAGFIN"/>
                    <property name="titulo" length="1024" column="TNE_TITULO"/>
                    <property name="enlace" length="512" column="TNE_ENLACE"/>
                    <property name="responsable" length="512" column="TNE_RESPON"/>
                    <many-to-one  cascade="all" name="archivo" column="TNE_CODARC" foreign-key="RSC_TNEARC_FK"/>
                    <property name="observaciones" length="4000" column="TNE_OBSERV"/>
                </composite-element>
            </map>
            <subclass name="org.ibit.rol.sac.model.NormativaExternaRemota" discriminator-value="normativaExternaRemota">
                <property name="idExterno" column="NER_IDEXTE"/>
                <property name="urlRemota" length="512" column="NER_URLREM"/>
                <many-to-one name="administracionRemota" column="NER_CODADM" foreign-key="RSC_NERADM_FK" />
            </subclass>
        </subclass>
    </class>
</hibernate-mapping>